# README
These scripts are for filtering VCF files and processing them with the R package _poppr_ to reproduce the PCA that was generated using PLINK. Currently, the % variation is substantially reduced compared to the PLINK PCA plot. I have eliminated some possible culripts from consideration (in particular, the _Z. latifolia_ sample followed by the other pilot samples). Now, I think it might be related to the number of SNPs that are under consideration. That is what these scripts are trying to uncover. The minor allele frequency does seem important, but I think the PLINK plot used more than ~2,000 SNPs. Hopefully, these scripts will show that that is the issue (which will also resolve the low Fst values that VCFtools is currently giving).

## PCA_from_VCFtools.R
This is an R script that reads in a VCF file and makes a PCA plot using the R package _poppr_. Any VCF file can be used, but my intention is to use VCF files that were filtered using VCFtools. Specifically, the filtering is done using another script in this repository: **filter_vcf_with_vcftools.sh**. We want to replicate the results that were found using PLINK. This script is quite memory-intensive, so be sure to submit it to an appropriate MSI queue (e.g., "**qsub -q mangi filter_vcf_with_vcftools.sh**"). Please be careful if you run this more than once. You may want to change output files (the PDF file of the PCA and the Rdata file) so you don't accidentally overwrite something that you may want/need. If you have altered the name of the output file from **filter_vcf_with_vcftools.sh** to something that better suits your style, you should also change the input name of the VCF file here.

## filter_vcf_with_vcftools.sh
This is a PBS script that you will submit to the MSI queue ("**qsub filter_vcf_with_vcftools.sh**"). There is no need to specify a special queue; it will simply go to the small queue which is more than sufficient. It isn't so memory intensive (set to 15 Gb). Run time will be about half an hour with the current parameters. This could change if you wanted to allow more missing data or change some other parameter. Before running, you may want to change the email address to your own so that you are informed when the script begins execution, when (if) it is aborted prematurely, or when it completes successfully.

## run_plot_PCA_from_vcftools.sh
This is a PBS script that you will submit to the MSI queue ("**qsub -q mangi run_plot_PCA_from_vcftools.sh**") in order to run the R script **PCA_from_VCFtools.R**. Note that it has a high memory request as well as run time. I set an earlier version of the script to 4 hours and it was not enough, even at 150 Gb memory. Before running, you may want to change the email address to your own so that you are informed when the script begins execution, when (if) it is aborted prematurely, or when it completes successfully.
